import React, { useState } from 'react';
import { ForceGraph2D } from 'react-force-graph';
import { createRoot } from 'react-dom/client';

const initialNodes = [
  { id: '🧠 Content Type', type: 'category', color: '#00bcd4' },
  { id: '🕰 Temporal Dimension', type: 'category', color: '#ff9800' },
  { id: '🧭 Context / Location', type: 'category', color: '#4caf50' },
  { id: '💠 Emotional / Affective Tag', type: 'category', color: '#e91e63' },
  { id: '🧵 Thematic Thread', type: 'category', color: '#9c27b0' },
  { id: '📦 Form & Format', type: 'category', color: '#3f51b5' },
  { id: '🔁 Status or Actionability', type: 'category', color: '#ffc107' },
  { id: '🔒 Privacy & Access', type: 'category', color: '#f44336' },
];

const initialLinks = [];

export default function MemoryMap() {
  const [nodes, setNodes] = useState(initialNodes);
  const [links, setLinks] = useState(initialLinks);

  const addMemoryNode = (categoryId) => {
    const newId = `Node-${nodes.length}`;
    const newNode = {
      id: newId,
      type: 'memory',
      label: 'New Memory',
      color: '#ffffff'
    };
    setNodes([...nodes, newNode]);
    setLinks([...links, { source: categoryId, target: newId }]);
  };

  const handleNodeClick = (node) => {
    if (node.type === 'category') {
      addMemoryNode(node.id);
    }
  };

  return (
    <div style={{ width: '100vw', height: '100vh', background: '#000000' }}>
      <ForceGraph2D
        graphData={{ nodes, links }}
        nodeLabel={(node) => node.id}
        nodeCanvasObject={(node, ctx, globalScale) => {
          const label = node.id;
          const fontSize = 14 / globalScale;
          ctx.font = `${fontSize}px Sans-Serif`;
          ctx.fillStyle = node.color;
          ctx.beginPath();
          ctx.arc(node.x, node.y, node.type === 'category' ? 10 : 6, 0, 2 * Math.PI, false);
          ctx.fill();
          ctx.fillStyle = '#ffffff';
          ctx.fillText(label, node.x + 12, node.y + 4);
        }}
        onNodeClick={handleNodeClick}
        backgroundColor="#000000"
      />
    </div>
  );
}

const container = document.getElementById('root');
if (container) {
  const root = createRoot(container);
  root.render(<MemoryMap />);
}
