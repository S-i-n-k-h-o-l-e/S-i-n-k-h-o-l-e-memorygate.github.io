import React, { useState } from 'react';
import { ForceGraph2D } from 'react-force-graph';

const initialNodes = [
  { id: '🧠 Content Type', type: 'category' },
  { id: '🕰 Temporal Dimension', type: 'category' },
  { id: '🧭 Context / Location', type: 'category' },
  { id: '💠 Emotional / Affective Tag', type: 'category' },
  { id: '🧵 Thematic Thread', type: 'category' },
  { id: '📦 Form & Format', type: 'category' },
  { id: '🔁 Status or Actionability', type: 'category' },
  { id: '🔒 Privacy & Access', type: 'category' },
];

const initialLinks = [];

export default function MemoryMap() {
  const [nodes, setNodes] = useState(initialNodes);
  const [links, setLinks] = useState(initialLinks);

  const addMemoryNode = (categoryId) => {
    const newId = `Node-${nodes.length}`;
    const newNode = {
      id: newId,
      type: 'memory',
      label: 'New Memory',
    };
    setNodes([...nodes, newNode]);
    setLinks([...links, { source: categoryId, target: newId }]);
  };

  const handleNodeClick = (node) => {
    if (node.type === 'category') {
      addMemoryNode(node.id);
    }
  };

  return (
    <div className="w-screen h-screen bg-black text-white">
      <ForceGraph2D
        graphData={{ nodes, links }}
        nodeLabel={(node) => node.id}
        nodeCanvasObject={(node, ctx, globalScale) => {
          const label = node.id;
          const fontSize = 12 / globalScale;
          ctx.font = `${fontSize}px Sans-Serif`;
          ctx.fillStyle = node.type === 'category' ? '#00ffcc' : '#ffcc00';
          ctx.beginPath();
          ctx.arc(node.x, node.y, node.type === 'category' ? 10 : 6, 0, 2 * Math.PI, false);
          ctx.fill();
          ctx.fillStyle = '#ffffff';
          ctx.fillText(label, node.x + 12, node.y + 4);
        }}
        onNodeClick={handleNodeClick}
      />
    </div>
  );
}
